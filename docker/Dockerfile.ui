# syntax=docker/dockerfile:1.7

FROM python:3.13-slim AS base

ENV PYTHONDONTWRITEBYTECODE=1 \
    PYTHONUNBUFFERED=1 \
    PIP_NO_CACHE_DIR=1 \
    VIRTUAL_ENV=/app/.venv \
    PATH="/app/.venv/bin:$PATH" \
    BACKEND_URL=http://localhost:8000 \
    STREAMLIT_SERVER_PORT=8501

WORKDIR /app

RUN pip install --no-cache-dir --upgrade pip \
    && pip install --no-cache-dir uv

COPY src/__init__.py ./src/__init__.py
COPY src/ui ./src/ui

RUN uv pip install --system streamlit==1.49.1 requests==2.32.4

EXPOSE 8501

CMD ["streamlit", "run", "src/ui/main.py", "--server.port=8501", "--server.address=0.0.0.0"]
